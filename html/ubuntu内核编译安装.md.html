<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ubuntu内核编译安装</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="../static/normal.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">ubuntu内核编译安装</h1>
<p class="date">2020-05-24 15:10:23</p>
</header>
<nav id="TOC">
<ul>
<li><a href="#ubuntu内核编译安装">ubuntu内核编译安装</a><ul>
<li><a href="#下载源码">下载源码</a></li>
<li><a href="#编译工具安装">编译工具安装</a></li>
<li><a href="#开始选项配置">开始选项配置</a></li>
<li><a href="#编译内核">编译内核</a></li>
<li><a href="#安装">安装</a></li>
<li><a href="#配置选项">配置选项</a></li>
</ul></li>
</ul>
</nav>
<h1 id="ubuntu内核编译安装">ubuntu内核编译安装</h1>
<h2 id="下载源码">下载源码</h2>
<p>到linux内核网站下载源码 <a href="https://www.kernel.org/" class="uri">https://www.kernel.org/</a></p>
<p>国内可以从清华源pull</p>
<pre class="shell"><code>git clone https://mirrors.tuna.tsinghua.edu.cn/git/linux.git --depth 1</code></pre>
<h2 id="编译工具安装">编译工具安装</h2>
<pre class="shell"><code>sudo apt install libncurses5-dev libssl-dev 
sudo apt install build-essential openssl 
sudo apt install zlibc minizip 
sudo apt install libidn11-dev libidn11
sudo apt install bison flex</code></pre>
<p>之后编译缺什么安装什么</p>
<h2 id="开始选项配置">开始选项配置</h2>
<blockquote>
<p>可选 <code>sudo make mrproper</code> 清除编译过程中产生的所有中间文件 <code>sudo make clean</code> 清除上一次编译产生的中间文件</p>
</blockquote>
<p><code>sudo make menuconfig</code> 会出现图形化界面</p>
<blockquote>
<p>更多配置方法 make menuconfig - 基于文本彩色菜单和单选列表。这个选项可以加快开发者开发速度。需要安装ncurses(ncurses-devel)。 make nconfig - 基于文本的彩色菜单。需要安装curses (libcdk5-dev)。 make xconfig - QT/X-windows 界面。需要安装QT。 make gconfig - Gtk/X-windows 界面。需要安装GTK。 make oldconfig - 纯文本界面，但是其默认的问题是基于已有的本地配置文件。 make silentoldconfig - 和oldconfig相似，但是不会显示配置文件中已有的问题的回答。 make olddefconfig -和silentoldconfig相似，但有些问题已经以它们的默认值选择。 make defconfig - 这个选项将会创建一份以当前系统架构为基础的默认设置文件。 make <span class="math inline"><em>P</em><em>L</em><em>A</em><em>T</em><em>F</em><em>O</em><em>R</em><em>M</em><em>d</em><em>e</em><em>f</em><em>c</em><em>o</em><em>n</em><em>f</em><em>i</em><em>g</em> − <em>创</em><em>建</em><em>一</em><em>份</em><em>使</em><em>用</em><em>a</em><em>r</em><em>c</em><em>h</em>/</span>ARCH/configs/${PLATFORM}defconfig中的值的配置文件。 make allyesconfig - 这个选项将会创建一份尽可能多的问题回答都为‘yes’的配置文件。 make allmodconfig - 这个选项将会创建一份将尽可能多的内核部分配置为模块的配置文件。</p>
</blockquote>
<p>配置好所需选项后，exit</p>
<h2 id="编译内核">编译内核</h2>
<p><code>sudo make –j4</code> 开始编译（4线程并行）</p>
<h2 id="安装">安装</h2>
<pre class="shell"><code>sudo make modules_install        //安装内核模块
sudo make install      //安装内核</code></pre>
<p>有必要的话执行<code>sudo update-grub</code>升级grub选项</p>
<h2 id="配置选项">配置选项</h2>
<p><a href="https://blog.csdn.net/wangyachao0803/article/details/81380889" class="uri">https://blog.csdn.net/wangyachao0803/article/details/81380889</a></p>
</body>
</html>
